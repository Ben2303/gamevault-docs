"use strict";(self.webpackChunkcrackpipe_docs=self.webpackChunkcrackpipe_docs||[]).push([[6007],{9613:(e,a,n)=>{n.d(a,{Zo:()=>p,kt:()=>g});var t=n(9496);function i(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){i(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function o(e,a){if(null==e)return{};var n,t,i=function(e,a){if(null==e)return{};var n,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(i[n]=e[n]);return i}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=t.createContext({}),c=function(e){var a=t.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):s(s({},a),e)),n},p=function(e){var a=c(e.components);return t.createElement(l.Provider,{value:a},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},d=t.forwardRef((function(e,a){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=c(n),d=i,g=m["".concat(l,".").concat(d)]||m[d]||u[d]||r;return n?t.createElement(g,s(s({ref:a},p),{},{components:n})):t.createElement(g,s({ref:a},p))}));function g(e,a){var n=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=d;var o={};for(var l in a)hasOwnProperty.call(a,l)&&(o[l]=a[l]);o.originalType=e,o[m]="string"==typeof e?e:i,s[1]=o;for(var c=2;c<r;c++)s[c]=n[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2550:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var t=n(1163),i=(n(9496),n(9613));const r={sidebar_position:8},s="Images",o={unversionedId:"server-docs/images",id:"server-docs/images",title:"Images",description:"In Crackpipe, images play a crucial role in providing visual representations of games and users and enhancing the user experience. This page outlines how images are handled within the backend application.",source:"@site/docs/server-docs/images.md",sourceDirName:"server-docs",slug:"/server-docs/images",permalink:"/docs/server-docs/images",draft:!1,editUrl:"https://github.com/phalcode/crackpipe-docs/tree/master/docs/server-docs/images.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"docs",previous:{title:"Game Indexing and Information Retrieval",permalink:"/docs/server-docs/indexing-and-metadata"},next:{title:"Troubleshooting",permalink:"/docs/server-docs/troubleshooting"}},l={},c=[{value:"Image Persistence",id:"image-persistence",level:2},{value:"Image Reuse",id:"image-reuse",level:2},{value:"Image Cleanup",id:"image-cleanup",level:2},{value:"Cleanup Interval",id:"cleanup-interval",level:3},{value:"Image Retention Policy",id:"image-retention-policy",level:3},{value:"Database Cleanup",id:"database-cleanup",level:3},{value:"Filesystem Cleanup",id:"filesystem-cleanup",level:3},{value:"Conclusion",id:"conclusion",level:2}],p={toc:c},m="wrapper";function u(e){let{components:a,...n}=e;return(0,i.kt)(m,(0,t.Z)({},p,n,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"images"},"Images"),(0,i.kt)("p",null,"In Crackpipe, images play a crucial role in providing visual representations of games and users and enhancing the user experience. This page outlines how images are handled within the backend application."),(0,i.kt)("h2",{id:"image-persistence"},"Image Persistence"),(0,i.kt)("p",null,"To ensure availability, performance, and efficient compression, Crackpipe persists all images on the filesystem using the ",(0,i.kt)("inlineCode",{parentName:"p"},"/images")," directory and the database. This includes various types of images, such as box arts, screenshots, and thumbnails. The storage path ",(0,i.kt)("inlineCode",{parentName:"p"},"/images")," for images can be customized by modifying the ",(0,i.kt)("inlineCode",{parentName:"p"},"IMAGE_STORAGE_PATH")," environment variable."),(0,i.kt)("h2",{id:"image-reuse"},"Image Reuse"),(0,i.kt)("p",null,"Crackpipe utilizes image reuse to optimize storage and reduce duplication. When multiple games or entities share the same image, Crackpipe avoids redundant storage by referencing the same image in the database."),(0,i.kt)("h2",{id:"image-cleanup"},"Image Cleanup"),(0,i.kt)("p",null,"To maintain a clean and efficient image storage system, Crackpipe regularly performs image cleanup. This process involves removing images that are no longer in use and also are older than a specified number of days."),(0,i.kt)("h3",{id:"cleanup-interval"},"Cleanup Interval"),(0,i.kt)("p",null,"The server initiates the image cleanup process at regular intervals determined by the ",(0,i.kt)("inlineCode",{parentName:"p"},"IMAGE_GC_INTERVAL_MINUTES")," environment variable. By default, the cleanup process runs every 60 minutes."),(0,i.kt)("h3",{id:"image-retention-policy"},"Image Retention Policy"),(0,i.kt)("p",null,"Crackpipe follows an image retention policy to determine which images should be removed. Images that meet the following criteria are eligible for deletion:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Not in Use: Images that are no longer associated with any games or entities in the application."),(0,i.kt)("li",{parentName:"ul"},"Exceed Retention Period: Images that are older than a specified number of days, as defined by the ",(0,i.kt)("inlineCode",{parentName:"li"},"IMAGE_GC_KEEP_DAYS")," environment variable. By default, images older than 30 days are considered for deletion.")),(0,i.kt)("h3",{id:"database-cleanup"},"Database Cleanup"),(0,i.kt)("p",null,"During the image cleanup process, Crackpipe hard removes the images from the database, ensuring they are no longer referenced by any entities."),(0,i.kt)("h3",{id:"filesystem-cleanup"},"Filesystem Cleanup"),(0,i.kt)("p",null,"Unlike database cleanup, for now, Crackpipe refrains from deleting images from the filesystem. This decision is made to prevent potential data loss or unintended consequences, such as the inability to access images if a volume mapping issue occurs."),(0,i.kt)("h2",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"The image handling in Crackpipe aims to strike a balance between availability, performance, and data integrity. By persisting images on the filesystem and employing an image cleanup process, Crackpipe ensures a reliable and efficient image management system within the application."))}u.isMDXComponent=!0}}]);